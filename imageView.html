<!DOCTYPE html>
<html>
        <head>
                <meta charset="UTF-8">
                <meta name="viewport" content="width=device-width, initial-scale=1.0">
                <title>Image</title>
                <link rel="icon" type="image/x-icon" href="../assets/images/icon.jpg">
                <link href="../styles.css" rel="stylesheet" type="text/css" media="all">
                <script src = "scripts.js"></script>
                <script>
                        function imageLoad(){
                                const image = document.getElementById("image")
                                queryString = String(window.location.href.split("?")[1])

                                imageURL = queryString.slice(9)

                                console.log("imageURL:", imageURL)
                                image.src = imageURL
                                image.style.content = "image-set('" + imageURL + "')"
                        }
                        function imageFitToFrame(imageVAL=null){
                                const image = document.querySelector("img")
                                const imageStyle = getComputedStyle(image)
                                if(imageVAL==null){                                        
                                        baseImage = new Image()
                                        baseImage.src = image.src
                                        baseImage.onload = imageFitToFrame(baseImage)
                                }
                                else{   
                                        run = true
                                        checkDelay = 250
                                        sleep(500).then(()=>{
                                                console.log(imageVAL.naturalHeight);
                                                h = imageVAL.naturalHeight
                                                shrinkValue = image.height / h
                                                actualWidth = imageVAL.width*shrinkValue
                                                console.log(actualWidth);
                                                
                                                if(actualWidth > document.body.offsetWidth){
                                                        shrinkValue = document.body.offsetWidth / actualWidth
                                                        newWidth = actualWidth*shrinkValue
                                                        newHeight = Math.floor(Number(imageStyle.height.slice(0,imageStyle.height.length-2))*shrinkValue) + "px"

                                                        image.width = newWidth
                                                        console.log(newWidth);
                                                        
                                                        image.height = newHeight
                                                        console.log(newHeight);
                                                        image.style.height = newHeight
                                                }

                                                if (h==0) {
                                                        imageFitToFrame(imageVAL)
                                                }
                                        })
                                        
                                }
                        }

                </script>
                <style>
                        .holder{
                                position: fixed;
                                right: 0px;
                                top:0px;
                                width: 100vw;
                        }
                </style>
        </head>

        <body class = "index_Back">
                <div class= "backing"></div>
                <div class= "cover"></div>
                <div class = "top">
                        <div class = "links">
                                <a tabindex="1" href = "../socials.html">Socials</a>
                                <a tabindex="1" href = "." >Home</a>
                                <a tabindex="1" href = "../characters">Characters</a>
                                <a tabindex="1" href = "../Fanart" class="fanart">Fanart</a>
                                <a tabindex="1" href = "./C&C/" >C&C</a>
                                <a tabindex="1" href = "../credits.html" style="margin-right: 15%;" class="credits">Credits</a>
                        </div>
                </div>
        
                <div class="holder" style="text-align: center;">
                        <img class="viewer" id="image" >
                </div>
                <div class = "bottom">
                </div>
                <br>
        </body>
        <script>
                imageLoad()
                imageFitToFrame()
        </script>
</html>
